# Design Document - Aba de EstatÃ­sticas (v1.1.0)

## ğŸ“‹ VisÃ£o Geral

Migrar o widget de estatÃ­sticas da `HomeScreen` para a `EisenhowerScreen`,
implementando uma interface com abas (TabBar) para otimizar o espaÃ§o e fornecer
dados dinÃ¢micos e contextualizados sobre as tarefas da Matriz de Eisenhower.

---

## ğŸ¯ Objetivos

1. **Otimizar espaÃ§o** na HomeScreen removendo widget de estatÃ­sticas estÃ¡tico
2. **Contextualizar dados** mostrando estatÃ­sticas especÃ­ficas da Matriz de
   Eisenhower
3. **Dados dinÃ¢micos** usando `Consumer<TasksNotifier>` para valores reais do
   banco
4. **Melhorar UX** com navegaÃ§Ã£o por abas (Matriz | EstatÃ­sticas)

---

## ğŸ—ï¸ Arquitetura Proposta

### Estrutura de Abas

```
EisenhowerScreen
â”œâ”€ DefaultTabController (2 tabs)
â”‚  â”œâ”€ AppBar com TabBar
â”‚  â”‚  â”œâ”€ Tab 1: "Matriz" ğŸ“Š
â”‚  â”‚  â””â”€ Tab 2: "EstatÃ­sticas" ğŸ“ˆ
â”‚  â””â”€ TabBarView
â”‚     â”œâ”€ MatrixView (grid 2x2 atual)
â”‚     â””â”€ StatisticsView (novo widget)
```

### Widget de EstatÃ­sticas (StatisticsView)

```dart
class StatisticsView extends StatelessWidget {
  Widget build(BuildContext context) {
    return Consumer<TasksNotifier>(
      builder: (context, notifier, _) {
        // CÃ¡lculos dinÃ¢micos
        final stats = _calculateStats(notifier.tasks);
        
        return SingleChildScrollView(
          child: Column(
            children: [
              _buildOverviewCards(stats),
              _buildQuadrantBreakdown(stats),
              _buildDeadlineStatus(stats),
              _buildCompletionChart(stats),
            ],
          ),
        );
      },
    );
  }
}
```

---

## ğŸ“Š Dados a Exibir

### 1. VisÃ£o Geral (Cards Superiores)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Total       â”‚ ConcluÃ­das  â”‚ Pendentes   â”‚
â”‚ ğŸ”¢ 23       â”‚ âœ… 15       â”‚ â³ 8        â”‚
â”‚             â”‚ 65%         â”‚ 35%         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. DistribuiÃ§Ã£o por Quadrante

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Q1 - Urgente e Importante      ğŸ”´       â”‚
â”‚ â–“â–“â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 8 tarefas (35%)      â”‚
â”‚ ConcluÃ­das: 3 | Pendentes: 5           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Q2 - NÃ£o Urgente e Importante  ğŸŸ¢       â”‚
â”‚ â–“â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 6 tarefas (26%)      â”‚
â”‚ ConcluÃ­das: 4 | Pendentes: 2           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Q3 - Urgente e NÃ£o Importante  ğŸŸ        â”‚
â”‚ â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 5 tarefas (22%)      â”‚
â”‚ ConcluÃ­das: 3 | Pendentes: 2           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Q4 - NÃ£o Urgente e NÃ£o Importante ğŸ”µ    â”‚
â”‚ â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 4 tarefas (17%)      â”‚
â”‚ ConcluÃ­das: 5 | Pendentes: -1          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Status de Prazos

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Alertas de Prazo                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš ï¸  Vencidas:      3 tarefas            â”‚
â”‚ â° Vence hoje:     2 tarefas            â”‚
â”‚ ğŸ“… Vence amanhÃ£:   4 tarefas            â”‚
â”‚ ğŸ“… Vence em 2 dias: 1 tarefa            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. GrÃ¡fico de ConclusÃ£o (Opcional)

```
GrÃ¡fico de pizza ou barras mostrando:
- % de tarefas concluÃ­das por quadrante
- TendÃªncia semanal/mensal
```

---

## ğŸ’» ImplementaÃ§Ã£o TÃ©cnica

### 1. Modificar EisenhowerScreen

**Atual:**

```dart
class EisenhowerScreen extends StatefulWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: CustomAppBar(...),
      body: _buildGrid(...),  // Grid direto
    );
  }
}
```

**Novo:**

```dart
class EisenhowerScreen extends StatefulWidget {
  @override
  Widget build(BuildContext context) {
    return DefaultTabController(
      length: 2,
      child: Scaffold(
        appBar: CustomAppBar(
          title: 'Matriz de Eisenhower',
          bottom: TabBar(
            tabs: [
              Tab(icon: Icon(Icons.grid_4x4), text: 'Matriz'),
              Tab(icon: Icon(Icons.bar_chart), text: 'EstatÃ­sticas'),
            ],
          ),
        ),
        body: TabBarView(
          children: [
            _MatrixView(),      // Grid atual
            _StatisticsView(),  // Novo widget
          ],
        ),
      ),
    );
  }
}
```

### 2. Criar TaskStatistics Helper

```dart
class TaskStatistics {
  final int total;
  final int completed;
  final int pending;
  final Map<int, QuadrantStats> byQuadrant;
  final DeadlineStats deadlines;
  
  factory TaskStatistics.fromTasks(List<Task> tasks) {
    // Calcular todas as estatÃ­sticas
  }
}

class QuadrantStats {
  final int total;
  final int completed;
  final int pending;
  final double percentage;
}

class DeadlineStats {
  final int overdue;
  final int today;
  final int tomorrow;
  final int twoDays;
}
```

### 3. Widget de EstatÃ­sticas

```dart
class _StatisticsView extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Consumer<TasksNotifier>(
      builder: (context, notifier, _) {
        if (notifier.isLoading) {
          return Center(child: CircularProgressIndicator());
        }
        
        final stats = TaskStatistics.fromTasks(notifier.tasks);
        
        return SingleChildScrollView(
          padding: EdgeInsets.all(16),
          child: Column(
            children: [
              _OverviewCards(stats: stats),
              SizedBox(height: 16),
              _QuadrantBreakdown(stats: stats),
              SizedBox(height: 16),
              _DeadlineAlerts(stats: stats),
            ],
          ),
        );
      },
    );
  }
}
```

---

## ğŸ¨ Design Visual

### Paleta de Cores (Manter consistÃªncia)

- Q1: `Colors.red[700]` (#C62828)
- Q2: `Colors.green[700]` (#388E3C)
- Q3: `Colors.orange[700]` (#F57C00)
- Q4: `Colors.blue[700]` (#1976D2)
- ConcluÃ­da: `Colors.green[100]` (background)
- Vencida: `Colors.red[100]` (background)

### Componentes UI

- **Cards**: `elevation: 2`, `borderRadius: 12`
- **Progress bars**: `LinearProgressIndicator` ou custom painted
- **Icons**: Material Icons consistentes
- **Typography**: Material 3 TextTheme

---

## ğŸ”„ Fluxo de Dados

```
1. TabBarView renderiza _StatisticsView

2. Consumer<TasksNotifier> escuta mudanÃ§as

3. notifier.tasks â†’ List<Task>

4. TaskStatistics.fromTasks(tasks) calcula:
   - total = tasks.length
   - completed = tasks.where((t) => t.isCompleted).length
   - pending = total - completed
   - byQuadrant[1] = tasks.where((t) => t.quadrant == 1)...
   - deadlines.overdue = tasks.where((t) => t.getDueStatus() == DueStatus.overdue).length

5. Widgets renderizam com dados calculados

6. Qualquer mudanÃ§a em tasks â†’ notifyListeners() â†’ rebuild automÃ¡tico
```

---

## âœ… CritÃ©rios de AceitaÃ§Ã£o

- [ ] TabBar funcional com 2 abas (Matriz | EstatÃ­sticas)
- [ ] EstatÃ­sticas calculadas dinamicamente do banco de dados
- [ ] Cards de visÃ£o geral (Total, ConcluÃ­das, Pendentes)
- [ ] Breakdown detalhado por quadrante com %
- [ ] Alertas de prazo (vencidas, hoje, prÃ³ximos dias)
- [ ] Rebuild automÃ¡tico ao adicionar/completar/mover tarefas
- [ ] Design consistente com Material 3 e cores do app
- [ ] Responsivo (adaptÃ¡vel a diferentes tamanhos de tela)
- [ ] Performance otimizada (cÃ¡lculos eficientes)

---

## ğŸ“¦ Arquivos a Criar/Modificar

### Criar:

- `lib/utils/task_statistics.dart` - Helper de cÃ¡lculos
- `lib/widgets/statistics_view.dart` - Widget principal
- `lib/widgets/overview_cards.dart` - Cards de resumo
- `lib/widgets/quadrant_breakdown.dart` - Breakdown por quadrante
- `lib/widgets/deadline_alerts.dart` - Alertas de prazo

### Modificar:

- `lib/screens/eisenhower_screen.dart` - Adicionar TabBar
- `lib/screens/home_screen.dart` - Remover widget de estatÃ­sticas estÃ¡tico

---

## ğŸ§ª Testes a Realizar

1. **Funcionalidade**:
   - Adicionar tarefa â†’ estatÃ­sticas atualizam
   - Completar tarefa â†’ % de conclusÃ£o muda
   - Mover tarefa â†’ distribuiÃ§Ã£o por quadrante atualiza
   - Excluir tarefa â†’ total diminui

2. **Performance**:
   - Testar com 0, 10, 50, 100+ tarefas
   - Verificar rebuild apenas quando necessÃ¡rio
   - CÃ¡lculos nÃ£o devem travar UI

3. **UI/UX**:
   - NavegaÃ§Ã£o fluida entre abas
   - Indicadores de carregamento apropriados
   - Mensagem quando nÃ£o hÃ¡ tarefas

---

## ğŸš€ Estimativa de ImplementaÃ§Ã£o

- **Complexidade**: MÃ©dia
- **Tempo estimado**: 4-6 horas
- **DependÃªncias**: Nenhuma (usa Provider jÃ¡ implementado)
- **Prioridade**: Alta (melhoria significativa de UX)

---

## ğŸ“ Notas Adicionais

- Considerar adicionar grÃ¡ficos com package `fl_chart` em versÃ£o futura
- Possibilidade de exportar estatÃ­sticas em PDF (v1.2.0)
- Filtros por perÃ­odo (semana, mÃªs) podem ser adicionados depois
- Manter widget simples na HomeScreen como "preview" das estatÃ­sticas
